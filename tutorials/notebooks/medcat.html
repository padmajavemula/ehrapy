<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<meta property="og:title" content="Extracting from free text with MedCAT" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://ehrapy.readthedocs.io/en/latest/tutorials/notebooks/medcat.html" />
<meta property="og:site_name" content="ehrapy" />
<meta property="og:description" content="This tutorial serves as an introduction on how to use ehrapy together with MedCAT. MedCat is a tool to extract medical entities from free text and link it to biomedical ontologies. Biomedical entit..." />
<meta property="og:image" content="https://ehrapy.readthedocs.io/en/latest//_static/logo.png" />
<meta property="og:image:alt" content="ehrapy" />
<meta name="description" content="This tutorial serves as an introduction on how to use ehrapy together with MedCAT. MedCat is a tool to extract medical entities from free text and link it to biomedical ontologies. Biomedical entit..." />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Contributor Guide" href="../../contributing.html" /><link rel="prev" title="Diabetes 130 Vignette" href="diabetes_130.html" />

    <!-- Generated with Sphinx 5.3.0 and Furo 2022.12.07 -->
        <title>Extracting from free text with MedCAT - ehrapy</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?digest=91d0f0d1c444bdcb17a68e833c7a53903343c195" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/override.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/sphinx_gallery.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --color-brand-primary: #003262;
  --color-brand-content: #003262;
  --admonition-font-size: var(--font-size-normal);
  --admonition-title-font-size: var(--font-size-normal);
  --code-font-size: var(--font-size--small);
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">ehrapy</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand centered" href="../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../_static/ehrapy_pure.png" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../usage/usage.html">Usage</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../usage/io/ehrapy.io.read_csv.html">ehrapy.io.read_csv</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/io/ehrapy.io.read_h5ad.html">ehrapy.io.read_h5ad</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/io/ehrapy.io.write.html">ehrapy.io.write</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/data/ehrapy.data.mimic_2.html">ehrapy.data.mimic_2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/data/ehrapy.data.mimic_3_demo.html">ehrapy.data.mimic_3_demo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/data/ehrapy.data.diabetes_130.html">ehrapy.data.diabetes_130</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/data/ehrapy.data.heart_failure.html">ehrapy.data.heart_failure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/data/ehrapy.data.chronic_kidney_disease.html">ehrapy.data.chronic_kidney_disease</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/data/ehrapy.data.breast_tissue.html">ehrapy.data.breast_tissue</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/data/ehrapy.data.cervical_cancer_risk_factors.html">ehrapy.data.cervical_cancer_risk_factors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/data/ehrapy.data.dermatology.html">ehrapy.data.dermatology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/data/ehrapy.data.echocardiogram.html">ehrapy.data.echocardiogram</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/data/ehrapy.data.heart_disease.html">ehrapy.data.heart_disease</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/data/ehrapy.data.hepatitis.html">ehrapy.data.hepatitis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/data/ehrapy.data.statlog_heart.html">ehrapy.data.statlog_heart</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/data/ehrapy.data.thyroid.html">ehrapy.data.thyroid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/data/ehrapy.data.breast_cancer_coimbra.html">ehrapy.data.breast_cancer_coimbra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/data/ehrapy.data.parkinson_dataset_with_replicated_acoustic_features.html">ehrapy.data.parkinson_dataset_with_replicated_acoustic_features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/data/ehrapy.data.parkinsons.html">ehrapy.data.parkinsons</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/data/ehrapy.data.parkinsons_disease_classification.html">ehrapy.data.parkinsons_disease_classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/data/ehrapy.data.parkinsons_telemonitoring.html">ehrapy.data.parkinsons_telemonitoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/preprocessing/ehrapy.preprocessing.pca.html">ehrapy.preprocessing.pca</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/preprocessing/ehrapy.preprocessing.regress_out.html">ehrapy.preprocessing.regress_out</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/preprocessing/ehrapy.preprocessing.subsample.html">ehrapy.preprocessing.subsample</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/preprocessing/ehrapy.preprocessing.highly_variable_features.html">ehrapy.preprocessing.highly_variable_features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/preprocessing/ehrapy.preprocessing.winsorize.html">ehrapy.preprocessing.winsorize</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/preprocessing/ehrapy.preprocessing.clip_quantile.html">ehrapy.preprocessing.clip_quantile</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/preprocessing/ehrapy.preprocessing.qc_metrics.html">ehrapy.preprocessing.qc_metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/preprocessing/ehrapy.preprocessing.qc_lab_measurements.html">ehrapy.preprocessing.qc_lab_measurements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/preprocessing/ehrapy.preprocessing.explicit_impute.html">ehrapy.preprocessing.explicit_impute</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/preprocessing/ehrapy.preprocessing.simple_impute.html">ehrapy.preprocessing.simple_impute</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/preprocessing/ehrapy.preprocessing.knn_impute.html">ehrapy.preprocessing.knn_impute</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/preprocessing/ehrapy.preprocessing.miss_forest_impute.html">ehrapy.preprocessing.miss_forest_impute</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/preprocessing/ehrapy.preprocessing.soft_impute.html">ehrapy.preprocessing.soft_impute</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/preprocessing/ehrapy.preprocessing.iterative_svd_impute.html">ehrapy.preprocessing.iterative_svd_impute</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/preprocessing/ehrapy.preprocessing.matrix_factorization_impute.html">ehrapy.preprocessing.matrix_factorization_impute</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/preprocessing/ehrapy.preprocessing.nuclear_norm_minimization_impute.html">ehrapy.preprocessing.nuclear_norm_minimization_impute</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/preprocessing/ehrapy.preprocessing.mice_forest_impute.html">ehrapy.preprocessing.mice_forest_impute</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/preprocessing/ehrapy.preprocessing.encode.html">ehrapy.preprocessing.encode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/preprocessing/ehrapy.preprocessing.undo_encoding.html">ehrapy.preprocessing.undo_encoding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/preprocessing/ehrapy.preprocessing.log_norm.html">ehrapy.preprocessing.log_norm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/preprocessing/ehrapy.preprocessing.maxabs_norm.html">ehrapy.preprocessing.maxabs_norm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/preprocessing/ehrapy.preprocessing.minmax_norm.html">ehrapy.preprocessing.minmax_norm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/preprocessing/ehrapy.preprocessing.power_norm.html">ehrapy.preprocessing.power_norm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/preprocessing/ehrapy.preprocessing.quantile_norm.html">ehrapy.preprocessing.quantile_norm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/preprocessing/ehrapy.preprocessing.robust_scale_norm.html">ehrapy.preprocessing.robust_scale_norm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/preprocessing/ehrapy.preprocessing.scale_norm.html">ehrapy.preprocessing.scale_norm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/preprocessing/ehrapy.preprocessing.sqrt_norm.html">ehrapy.preprocessing.sqrt_norm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/preprocessing/ehrapy.preprocessing.offset_negative_values.html">ehrapy.preprocessing.offset_negative_values</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/preprocessing/ehrapy.preprocessing.combat.html">ehrapy.preprocessing.combat</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/preprocessing/ehrapy.preprocessing.neighbors.html">ehrapy.preprocessing.neighbors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/tools/ehrapy.tools.pca.html">ehrapy.tools.pca</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/tools/ehrapy.tools.tsne.html">ehrapy.tools.tsne</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/tools/ehrapy.tools.umap.html">ehrapy.tools.umap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/tools/ehrapy.tools.draw_graph.html">ehrapy.tools.draw_graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/tools/ehrapy.tools.diffmap.html">ehrapy.tools.diffmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/tools/ehrapy.tools.embedding_density.html">ehrapy.tools.embedding_density</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/tools/ehrapy.tools.leiden.html">ehrapy.tools.leiden</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/tools/ehrapy.tools.louvain.html">ehrapy.tools.louvain</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/tools/ehrapy.tools.dendrogram.html">ehrapy.tools.dendrogram</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/tools/ehrapy.tools.dpt.html">ehrapy.tools.dpt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/tools/ehrapy.tools.paga.html">ehrapy.tools.paga</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/tools/ehrapy.tools.rank_features_groups.html">ehrapy.tools.rank_features_groups</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/tools/ehrapy.tools.filter_rank_features_groups.html">ehrapy.tools.filter_rank_features_groups</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/tools/ehrapy.tools.marker_feature_overlap.html">ehrapy.tools.marker_feature_overlap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/tools/ehrapy.tools.ingest.html">ehrapy.tools.ingest</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/tools/ehrapy.tools.Translator.html">ehrapy.tools.Translator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/tools/ehrapy.tools.HPOMapper.html">ehrapy.tools.HPOMapper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/tools/ehrapy.tools.MedCAT.html">ehrapy.tools.MedCAT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/tools/ehrapy.tools.mc.run_unsupervised_training.html">ehrapy.tools.mc.run_unsupervised_training</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/tools/ehrapy.tools.mc.annotate_text.html">ehrapy.tools.mc.annotate_text</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/tools/ehrapy.tools.mc.get_annotation_overview.html">ehrapy.tools.mc.get_annotation_overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/tools/ehrapy.tools.ols.html">ehrapy.tools.ols</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/tools/ehrapy.tools.glm.html">ehrapy.tools.glm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/tools/ehrapy.tools.kmf.html">ehrapy.tools.kmf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/plot/ehrapy.plot.scatter.html">ehrapy.plot.scatter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/plot/ehrapy.plot.heatmap.html">ehrapy.plot.heatmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/plot/ehrapy.plot.dotplot.html">ehrapy.plot.dotplot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/plot/ehrapy.plot.tracksplot.html">ehrapy.plot.tracksplot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/plot/ehrapy.plot.violin.html">ehrapy.plot.violin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/plot/ehrapy.plot.stacked_violin.html">ehrapy.plot.stacked_violin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/plot/ehrapy.plot.matrixplot.html">ehrapy.plot.matrixplot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/plot/ehrapy.plot.clustermap.html">ehrapy.plot.clustermap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/plot/ehrapy.plot.ranking.html">ehrapy.plot.ranking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/plot/ehrapy.plot.dendrogram.html">ehrapy.plot.dendrogram</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/plot/ehrapy.plot.qc_metrics.html">ehrapy.plot.qc_metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/plot/ehrapy.plot.missing_values_matrix.html">ehrapy.plot.missing_values_matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/plot/ehrapy.plot.missing_values_barplot.html">ehrapy.plot.missing_values_barplot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/plot/ehrapy.plot.missing_values_heatmap.html">ehrapy.plot.missing_values_heatmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/plot/ehrapy.plot.missing_values_dendrogram.html">ehrapy.plot.missing_values_dendrogram</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/plot/ehrapy.plot.pca.html">ehrapy.plot.pca</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/plot/ehrapy.plot.pca_loadings.html">ehrapy.plot.pca_loadings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/plot/ehrapy.plot.pca_variance_ratio.html">ehrapy.plot.pca_variance_ratio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/plot/ehrapy.plot.pca_overview.html">ehrapy.plot.pca_overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/plot/ehrapy.plot.tsne.html">ehrapy.plot.tsne</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/plot/ehrapy.plot.umap.html">ehrapy.plot.umap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/plot/ehrapy.plot.diffmap.html">ehrapy.plot.diffmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/plot/ehrapy.plot.draw_graph.html">ehrapy.plot.draw_graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/plot/ehrapy.plot.spatial.html">ehrapy.plot.spatial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/plot/ehrapy.plot.embedding.html">ehrapy.plot.embedding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/plot/ehrapy.plot.embedding_density.html">ehrapy.plot.embedding_density</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/plot/ehrapy.plot.dpt_groups_pseudotime.html">ehrapy.plot.dpt_groups_pseudotime</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/plot/ehrapy.plot.dpt_timeseries.html">ehrapy.plot.dpt_timeseries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/plot/ehrapy.plot.paga.html">ehrapy.plot.paga</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/plot/ehrapy.plot.paga_path.html">ehrapy.plot.paga_path</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/plot/ehrapy.plot.paga_compare.html">ehrapy.plot.paga_compare</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/plot/ehrapy.plot.rank_features_groups.html">ehrapy.plot.rank_features_groups</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/plot/ehrapy.plot.rank_features_groups_violin.html">ehrapy.plot.rank_features_groups_violin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/plot/ehrapy.plot.rank_features_groups_stacked_violin.html">ehrapy.plot.rank_features_groups_stacked_violin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/plot/ehrapy.plot.rank_features_groups_heatmap.html">ehrapy.plot.rank_features_groups_heatmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/plot/ehrapy.plot.rank_features_groups_dotplot.html">ehrapy.plot.rank_features_groups_dotplot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/plot/ehrapy.plot.rank_features_groups_matrixplot.html">ehrapy.plot.rank_features_groups_matrixplot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/plot/ehrapy.plot.rank_features_groups_tracksplot.html">ehrapy.plot.rank_features_groups_tracksplot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/plot/ehrapy.plot.ols.html">ehrapy.plot.ols</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/plot/ehrapy.plot.kmf.html">ehrapy.plot.kmf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/anndata/ehrapy.anndata.df_to_anndata.html">ehrapy.anndata.df_to_anndata</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/anndata/ehrapy.anndata.anndata_to_df.html">ehrapy.anndata.anndata_to_df</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/anndata/ehrapy.anndata.move_to_obs.html">ehrapy.anndata.move_to_obs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/anndata/ehrapy.anndata.delete_from_obs.html">ehrapy.anndata.delete_from_obs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/anndata/ehrapy.anndata.move_to_x.html">ehrapy.anndata.move_to_x</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/anndata/ehrapy.anndata.type_overview.html">ehrapy.anndata.type_overview</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">Tutorials</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ehrapy_introduction.html">Introduction to ehrapy</a></li>
<li class="toctree-l2"><a class="reference internal" href="mimic_2_introduction.html">MIMIC-II IAC Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="mimic_2_fate.html">MIMIC-II Patient Fate</a></li>
<li class="toctree-l2"><a class="reference internal" href="mimic_2_survival_analysis.html">MIMIC-II Survival Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="diabetes_130.html">Diabetes 130 Vignette</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Extracting from free text with MedCAT</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributor Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../code_of_conduct.html">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/theislab/ehrapy/discussions">Discussions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../authors.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">References</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars and line breaks on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
    white-space: pre;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<style>
    p {
        margin-bottom: 0.5rem;
    }
    /* Main index page overview cards */
    /* https://github.com/spatialaudio/nbsphinx/pull/635/files */
    .jp-RenderedHTMLCommon table,
    div.rendered_html table {
    border: none;
    border-collapse: collapse;
    border-spacing: 0;
    font-size: 12px;
    table-layout: fixed;
    color: inherit;
    }

    body:not([data-theme=light]) .jp-RenderedHTMLCommon tbody tr:nth-child(odd),
    body:not([data-theme=light]) div.rendered_html tbody tr:nth-child(odd) {
    background: rgba(255, 255, 255, .1);
    }
</style><div class="admonition note">
    <p class="admonition-title">Note</p>
    <p>
    This page was generated from
    <a class="reference external" href="https://github.com/theislab/ehrapy/tree/0.3.0/">medcat.ipynb</a>.
    Some tutorial content may look better in light mode.
    </p>
</div><section id="Extracting-from-free-text-with-MedCAT">
<h1>Extracting from free text with MedCAT<a class="headerlink" href="#Extracting-from-free-text-with-MedCAT" title="Permalink to this heading">#</a></h1>
<p>This tutorial serves as an introduction on how to use <em>ehrapy</em> together with <a class="reference external" href="https://github.com/CogStack/MedCAT">MedCAT</a>. <em>MedCat</em> is a tool to extract medical entities from free text and link it to biomedical ontologies. Biomedical entities could be anything biomedical; not only diagnoses or diseases but also symptoms, drugs or even peptides. It also tries to keep the context of an extracted entitiy (for example, whether a specific disease has been diagnosed or not). This is especially
important for electronic health records data, as most of the time doctors notes are simply copied and pasted into the data and not preprocessed in any form. Consider the following example:</p>
<ul class="simple">
<li><p>The patient suffers from diabetes.</p></li>
</ul>
<p>vs.</p>
<ul class="simple">
<li><p>The patient does not suffer from diabetes.</p></li>
</ul>
<p>In detail, ehrapy uses a pretrained and packages model from MedCat (<a class="reference external" href="https://medcat.readthedocs.io/en/latest/main.html#models">https://medcat.readthedocs.io/en/latest/main.html#models</a>). This model is limited in performance but good enough for this demonstration. A larger (trained) model is planned to be released somewhen in the (near) future by the MedCAT maintainers.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import ehrapy as ep
import pandas as pd
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #808000; text-decoration-color: #808000; font-weight: bold">Installed version </span><span style="color: #808000; text-decoration-color: #808000; font-weight: bold">0.3</span><span style="color: #808000; text-decoration-color: #808000; font-weight: bold">.</span><span style="color: #808000; text-decoration-color: #808000; font-weight: bold">0</span><span style="color: #808000; text-decoration-color: #808000; font-weight: bold"> of ehrapy is newer than the latest release </span><span style="color: #808000; text-decoration-color: #808000; font-weight: bold">0.2</span><span style="color: #808000; text-decoration-color: #808000; font-weight: bold">.</span><span style="color: #808000; text-decoration-color: #808000; font-weight: bold">0</span><span style="color: #808000; text-decoration-color: #808000; font-weight: bold">! You are running a </span>
<span style="color: #808000; text-decoration-color: #808000; font-weight: bold">nightly version and features may break!</span>
</pre></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/zeth/miniconda3/envs/ehrapy/lib/python3.8/site-packages/medcat/cat.py:18: TqdmExperimentalWarning: Using `tqdm.autonotebook.tqdm` in notebook mode. Use `tqdm.tqdm` instead to force console mode (e.g. in jupyter console)
  from tqdm.autonotebook import tqdm, trange
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>ep.settings.n_jobs = 8
</pre></div>
</div>
</div>
<p>Download the example data</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>!wget -nc https://raw.githubusercontent.com/CogStack/MedCATtutorials/main/notebooks/introductory/data/pt_notes.csv -P ./medcat_data/
!wget -nc https://medcat.rosalind.kcl.ac.uk/media/medmen_wstatus_2021_oct.zip -P ./medcat_data/
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
File ‘./medcat_data/pt_notes.csv’ already there; not retrieving.

File ‘./medcat_data/medmen_wstatus_2021_oct.zip’ already there; not retrieving.

</pre></div></div>
</div>
<section id="Custom-MedCAT-object-of-ehrapy">
<h2>Custom MedCAT object of ehrapy<a class="headerlink" href="#Custom-MedCAT-object-of-ehrapy" title="Permalink to this heading">#</a></h2>
<p>To allow for seemless interoperability of ehrapy and MedCAT, we require a “superobject” that references the AnnData object while providing the MedCAT functionality. This object further stores MedCAT related features such as a <em>vocabulary</em>, a <em>concept database</em> and (later on in this tutorial) also the <em>annotated results</em>.</p>
<p>First, we read the example data into an AnnData object, encode the data and calculate neighbors for subsequent processing. As a next step, we create the MedCAT object with a modelpack and set default TUI filters. A full list of TUI’s can be found at: <a class="reference external" href="https://lhncbc.nlm.nih.gov/ii/tools/MetaMap/Docs/SemanticTypes_2018AB.txt">https://lhncbc.nlm.nih.gov/ii/tools/MetaMap/Docs/SemanticTypes_2018AB.txt</a></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>adata = ep.io.read_csv(&quot;medcat_data/pt_notes.csv&quot;, columns_obs_only=[&quot;text&quot;])
adata_encoded = ep.pp.encode(adata, autodetect=True)
ep.pp.neighbors(adata_encoded)

# create the main ehrapy medcat object used for medical entitiy analysis using ehrapy and medcat
ep_medcat = ep.tl.MedCAT(
    adata_encoded, model_pack_path=&quot;./medcat_data/medmen_wstatus_2021_oct.zip&quot;
)
# only use diseases and behavioural disorders diagnoses in this example by filtering by TUI
ep_medcat.set_filter_by_tui(tuis=[&quot;T047&quot;, &quot;T048&quot;])
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "8ce12cbbceee431a8454f5df73eee63d", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">
</pre></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Unziping the model pack and loading models.
{
  &#34;Model ID&#34;: null,
  &#34;Last Modifed On&#34;: null,
  &#34;History (from least to most recent)&#34;: [],
  &#34;Description&#34;: &#34;No description&#34;,
  &#34;Source Ontology&#34;: null,
  &#34;Location&#34;: null,
  &#34;MetaCAT models&#34;: {},
  &#34;Basic CDB Stats&#34;: {},
  &#34;Performance&#34;: {
    &#34;ner&#34;: {},
    &#34;meta&#34;: {}
  },
  &#34;Important Parameters (Partial view, all available in cat.config)&#34;: {
    &#34;config.ner[&#39;min_name_len&#39;]&#34;: {
      &#34;value&#34;: 3,
      &#34;description&#34;: &#34;Minimum detection length (found terms/mentions shorter than this will not be detected).&#34;
    },
    &#34;config.ner[&#39;upper_case_limit_len&#39;]&#34;: {
      &#34;value&#34;: 3,
      &#34;description&#34;: &#34;All detected terms shorter than this value have to be uppercase, otherwise they will be ignored.&#34;
    },
    &#34;config.linking[&#39;similarity_threshold&#39;]&#34;: {
      &#34;value&#34;: 0.2,
      &#34;description&#34;: &#34;If the confidence of the model is lower than this a detection will be ignore.&#34;
    },
    &#34;config.general[&#39;spell_check&#39;]&#34;: {
      &#34;value&#34;: true,
      &#34;description&#34;: &#34;Is spell checking enabled.&#34;
    },
    &#34;config.general[&#39;spell_check_len_limit&#39;]&#34;: {
      &#34;value&#34;: 7,
      &#34;description&#34;: &#34;Words shorter than this will not be spell checked.&#34;
    }
  }
}
</pre></div></div>
</div>
<p>Using this model pack we can already extract entities from an example note.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>text = &quot;He was diagnosed with kidney failure&quot;
doc = ep_medcat.cat(text)
doc.ents
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(kidney failure,)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Example output of an extracted medcat entity; note that ehrapy will deal with this automatically and the here displayed manual extraction is not required.
# CUI: Concept Unique Identifier, which is just an unique identifier for each concept extracted
ep_medcat.cat.get_entities(&quot;He was diagnosed with kidney failure&quot;, only_cui=False)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;entities&#39;: {2: {&#39;pretty_name&#39;: &#39;Kidney Failure&#39;,
   &#39;cui&#39;: &#39;C0035078&#39;,
   &#39;type_ids&#39;: [&#39;T047&#39;],
   &#39;types&#39;: [&#39;Disease or Syndrome&#39;],
   &#39;source_value&#39;: &#39;kidney failure&#39;,
   &#39;detected_name&#39;: &#39;kidney~failure&#39;,
   &#39;acc&#39;: 1.0,
   &#39;context_similarity&#39;: 1.0,
   &#39;start&#39;: 22,
   &#39;end&#39;: 36,
   &#39;icd10&#39;: [],
   &#39;ontologies&#39;: [],
   &#39;snomed&#39;: [],
   &#39;id&#39;: 2,
   &#39;meta_anns&#39;: {&#39;Status&#39;: {&#39;value&#39;: &#39;Affirmed&#39;,
     &#39;confidence&#39;: 0.9999961853027344,
     &#39;name&#39;: &#39;Status&#39;}}}},
 &#39;tokens&#39;: []}
</pre></div></div>
</div>
</section>
<section id="Extracting-and-visualizing-all-disease-entities">
<h2>Extracting and visualizing all disease entities<a class="headerlink" href="#Extracting-and-visualizing-all-disease-entities" title="Permalink to this heading">#</a></h2>
<p>To extract all disease entities from our example dataset we require a complete annotation of the dataset. This step is computationally expensive and may take some time.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>ep.tl.mc.annotate_text(ep_medcat, text_column=&quot;text&quot;, n_proc=8)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Annotated until now: 0 docs; Current BS: 157 docs; Elapsed time: 0.00 minutes
Annotated until now: 157 docs; Current BS: 165 docs; Elapsed time: 0.37 minutes
Annotated until now: 322 docs; Current BS: 151 docs; Elapsed time: 0.86 minutes
Annotated until now: 473 docs; Current BS: 160 docs; Elapsed time: 1.36 minutes
Annotated until now: 633 docs; Current BS: 152 docs; Elapsed time: 1.87 minutes
Annotated until now: 785 docs; Current BS: 130 docs; Elapsed time: 2.35 minutes
Annotated until now: 915 docs; Current BS: 157 docs; Elapsed time: 2.81 minutes
Annotated until now: 1072 docs; Current BS: 16 docs; Elapsed time: 3.26 minutes
</pre></div></div>
</div>
<p>The annotated results as extracted by MedCAT are transformed and stored into a Pandas DataFrame</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>ep_medcat.annotated_results
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>row_nr</th>
      <th>pretty_name</th>
      <th>cui</th>
      <th>type_ids</th>
      <th>types</th>
      <th>meta_anns</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Diabetes</td>
      <td>C0011847</td>
      <td>[T047]</td>
      <td>[Disease or Syndrome]</td>
      <td>Affirmed</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>Sepsis</td>
      <td>C0243026</td>
      <td>[T047]</td>
      <td>[Disease or Syndrome]</td>
      <td>Other</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>Respiratory Distress Syndrome, Adult</td>
      <td>C0035222</td>
      <td>[T047]</td>
      <td>[Disease or Syndrome]</td>
      <td>Affirmed</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>Pulmonary Embolism</td>
      <td>C0034065</td>
      <td>[T047]</td>
      <td>[Disease or Syndrome]</td>
      <td>Other</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>Respiratory Failure</td>
      <td>C1145670</td>
      <td>[T047]</td>
      <td>[Disease or Syndrome]</td>
      <td>Affirmed</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>10781</th>
      <td>999</td>
      <td>Diabetes</td>
      <td>C0011847</td>
      <td>[T047]</td>
      <td>[Disease or Syndrome]</td>
      <td>Affirmed</td>
    </tr>
    <tr>
      <th>10782</th>
      <td>999</td>
      <td>Diabetes</td>
      <td>C0011847</td>
      <td>[T047]</td>
      <td>[Disease or Syndrome]</td>
      <td>Affirmed</td>
    </tr>
    <tr>
      <th>10783</th>
      <td>999</td>
      <td>Diabetes</td>
      <td>C0011847</td>
      <td>[T047]</td>
      <td>[Disease or Syndrome]</td>
      <td>Affirmed</td>
    </tr>
    <tr>
      <th>10784</th>
      <td>999</td>
      <td>Diabetes</td>
      <td>C0011847</td>
      <td>[T047]</td>
      <td>[Disease or Syndrome]</td>
      <td>Other</td>
    </tr>
    <tr>
      <th>10785</th>
      <td>999</td>
      <td>Diabetes Mellitus, Non-Insulin-Dependent</td>
      <td>C0011860</td>
      <td>[T047]</td>
      <td>[Disease or Syndrome]</td>
      <td>Affirmed</td>
    </tr>
  </tbody>
</table>
<p>10786 rows × 6 columns</p>
</div></div>
</div>
<p>We can also get a proper overview for the top 10 most entities found in the data (affirmed diagnoses only).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>ep.tl.mc.get_annotation_overview(ep_medcat)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">
 <span style="color: #800080; text-decoration-color: #800080; font-weight: bold"> pretty_name        </span> <span style="color: #800080; text-decoration-color: #800080; font-weight: bold"> type_ids </span> <span style="color: #800080; text-decoration-color: #800080; font-weight: bold"> types              </span> <span style="color: #800080; text-decoration-color: #800080; font-weight: bold"> n_patient_visit </span> <span style="color: #800080; text-decoration-color: #800080; font-weight: bold"> n_patient_visit_p… </span>
 ───────────────────────────────────────────────────────────────────────────────────────────
  Hypertensive         T047       Disease or           432               42.39450441609421
  disease                         Syndrome
 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> Obesity            </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> T047     </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> Disease or         </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> 245             </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> 24.043179587831208 </span>
 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                    </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">          </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> Syndrome           </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                 </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                    </span>
  Diabetes             T047       Disease or           149               14.622178606476938
                                  Syndrome
 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> Coronary           </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> T047     </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> Disease or         </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> 127             </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> 12.463199214916584 </span>
 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> Arteriosclerosis   </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">          </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> Syndrome           </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                 </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                    </span>
  Diabetes Mellitus    T047       Disease or           118               11.579980372914623
                                  Syndrome
 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> Disease            </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> T047     </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> Disease or         </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> 110             </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> 10.794896957801766 </span>
 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                    </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">          </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> Syndrome           </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                 </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                    </span>
  Cerebrovascular      T047       Disease or           110               10.794896957801766
  accident                        Syndrome
 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> Asthma             </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> T047     </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> Disease or         </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> 97              </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> 9.519136408243375  </span>
 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                    </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">          </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> Syndrome           </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                 </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                    </span>
  Chronic              T047       Disease or           92                9.028459273797841
  Obstructive Airway              Syndrome
  Disease
 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> Mental Depression  </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> T048     </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> Mental or          </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> 91              </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> 8.930323846908735  </span>
 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                    </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">          </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> Behavioral         </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                 </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                    </span>
 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                    </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">          </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> Dysfunction        </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                 </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                    </span>

</pre></div>
</div>
<p>Alternatively, we can also get an overview of the top 10 negated diagnoses only.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>ep.tl.mc.get_annotation_overview(ep_medcat, status=&quot;Other&quot;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">
 <span style="color: #800080; text-decoration-color: #800080; font-weight: bold"> pretty_name        </span> <span style="color: #800080; text-decoration-color: #800080; font-weight: bold"> type_ids </span> <span style="color: #800080; text-decoration-color: #800080; font-weight: bold"> types              </span> <span style="color: #800080; text-decoration-color: #800080; font-weight: bold"> n_patient_visit </span> <span style="color: #800080; text-decoration-color: #800080; font-weight: bold"> n_patient_visit_p… </span>
 ───────────────────────────────────────────────────────────────────────────────────────────
  Cerebrovascular      T047       Disease or           119               15.973154362416109
  accident                        Syndrome
 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> Erythema           </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> T047     </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> Disease or         </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> 85              </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> 11.409395973154362 </span>
 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                    </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">          </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> Syndrome           </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                 </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                    </span>
  Diabetes             T047       Disease or           78                10.46979865771812
                                  Syndrome
 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> Hypertensive       </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> T047     </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> Disease or         </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> 68              </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> 9.12751677852349   </span>
 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> disease            </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">          </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> Syndrome           </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                 </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                    </span>
  disorder lesions     T047       Disease or           68                9.12751677852349
  skin                            Syndrome
 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> Lymphadenopathy    </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> T047     </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> Disease or         </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> 64              </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> 8.590604026845638  </span>
 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                    </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">          </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> Syndrome           </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                 </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                    </span>
  nervous system       T047       Disease or           58                7.785234899328859
  disorder                        Syndrome
 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> Coronary           </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> T047     </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> Disease or         </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> 50              </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> 6.7114093959731544 </span>
 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> Arteriosclerosis   </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">          </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> Syndrome           </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                 </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                    </span>
  Drug abuse           T048       Mental or            50                6.7114093959731544
                                  Behavioral
                                  Dysfunction
 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> Pneumonia          </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> T047     </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> Disease or         </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> 50              </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> 6.7114093959731544 </span>
 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                    </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">          </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f"> Syndrome           </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                 </span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                    </span>

</pre></div>
</div>
<p>Since our MedCAT is aware of both, the annotation results and the AnnData object, we can just pass it to any plotting functions of ehrapy, just we like we are used to with AnnData objects. First, we calculate a UMAP embedding using the AnnData object and then we color by all patients that had some form of Pneumonia.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>ep.tl.umap(ep_medcat.anndata)
ep.pl.umap(ep_medcat, color=[&quot;Diabetes&quot;, &quot;Congestive heart failure&quot;])
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_medcat_20_0.png" src="../../_images/tutorials_notebooks_medcat_20_0.png" />
</div>
</div>
<p>It is still possible to color by the original columns in the AnnData object with the MedCAT object.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>ep.pl.umap(ep_medcat, color=[&quot;gender&quot;, &quot;age_year&quot;, &quot;Diabetes&quot;])
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_medcat_22_0.png" src="../../_images/tutorials_notebooks_medcat_22_0.png" />
</div>
</div>
<p>Passing an AnnData object instead of an ehrapy MedCAT object will also work, but not with extracted entities.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>ep.pl.umap(ep_medcat.anndata, color=[&quot;gender&quot;, &quot;age_year&quot;])
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_medcat_24_0.png" src="../../_images/tutorials_notebooks_medcat_24_0.png" />
</div>
</div>
<p>Typos are automatically fixed by ehrapy whenever possible.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>ep.pl.umap(ep_medcat, color=[&quot;Diubetes&quot;, &quot;Heart Failure&quot;])
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #808000; text-decoration-color: #808000; font-weight: bold">Did not find </span><span style="color: #000080; text-decoration-color: #000080; font-weight: bold">Diubetes </span><span style="color: #808000; text-decoration-color: #808000; font-weight: bold">in medcat's extracted entities. Will use best match Diabetes!</span>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #808000; text-decoration-color: #808000; font-weight: bold">Did not find </span><span style="color: #000080; text-decoration-color: #000080; font-weight: bold">Heart Failure </span><span style="color: #808000; text-decoration-color: #808000; font-weight: bold">in medcat's extracted entities. Will use best match Heart failure!</span>
</pre></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_medcat_26_2.png" src="../../_images/tutorials_notebooks_medcat_26_2.png" />
</div>
</div>
<p>All other features of ehrapy are of course also available.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>ep.tl.leiden(ep_medcat.anndata, resolution=0.5, key_added=&quot;leiden_0_5&quot;)
ep.tl.paga(ep_medcat.anndata, groups=&quot;leiden_0_5&quot;)

# paga currently does not support medcat extracted entities directly (as of ehrapy 0.2.0)
ep.pl.paga(
    ep_medcat.anndata,
    color=[&quot;leiden_0_5&quot;, &quot;gender&quot;],
    cmap=ep.pl.Colormaps.grey_red.value,
    title=[&quot;Leiden 0.5&quot;, &quot;Gender&quot;],
)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_medcat_28_0.png" src="../../_images/tutorials_notebooks_medcat_28_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>ep.tl.draw_graph(ep_medcat.anndata, init_pos=&quot;paga&quot;)
ep.pl.draw_graph(ep_medcat, color=[&quot;gender&quot;, &quot;Diabetes&quot;], legend_loc=&quot;on data&quot;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_medcat_29_0.png" src="../../_images/tutorials_notebooks_medcat_29_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>ep.pl.tracksplot(ep_medcat, list(ep_medcat.anndata.var_names), groupby=&quot;Diabetes&quot;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_medcat_30_0.png" src="../../_images/tutorials_notebooks_medcat_30_0.png" />
</div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../../contributing.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Contributor Guide</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="diabetes_130.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Diabetes 130 Vignette</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2021, Lukas Heumos, Theislab
            </div>
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Extracting from free text with MedCAT</a><ul>
<li><a class="reference internal" href="#Custom-MedCAT-object-of-ehrapy">Custom MedCAT object of ehrapy</a></li>
<li><a class="reference internal" href="#Extracting-and-visualizing-all-disease-entities">Extracting and visualizing all disease entities</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/scripts/furo.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/design-tabs.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>